### Deep Semantic Segmentation for Automated Driving: Taxonomy, Roadmap and Challenges

本文的工作：
- 调查了目前的语义分割算法，并讨论其如何适应自动驾驶的情况。
- 列出了语义分割算法为满足自动驾驶需要的准确性和健壮性需要面临的挑战。
- 探索不仅仅使用语义分割的方法的替代方案。
- 借助 CamVid 数据集，评估各种语义分割架构。

#### 引论

- 近年来图像语义分割研究取得了巨大的进展。只在将图像在语义上分割为多个有意义的部分。在机器人、医疗、增强现实和自动驾驶方面都有重要的用途。

- 现出现了两种自动驾驶解决思路：媒介感知方式，即解析整个场景并将其用于控制决策，但是这种方式使得系统更为复杂，且增加了成本；行为反映方式更多地借助端到端的学习将输入映射到控制决策。另外一种折中的方法，该方法可以学习驾驶场景的负担能力指标。然后，这些指示器可以在简单的控制器上进行反馈，以做出最终的驾驶决策。

#### 深度语义分割分类

- 该节分类别介绍了有关深度语义分割的文献工作。

- 目前在语义分割方面的研究可以分为四种不同的类别：在深度学习发展之前的经典方式，使用深度学习方式的完全卷积网络（FCN），利用之前语义分割结果的结构化模型，以及利用视频中的时空信息的模型（Spatio-Temporal Model）。

|Classical Methods| Fully Convolutional Networks| Structured Models |Spatio-Temporal Models|
|  ----  | ----  |----  |----  |
|Decision Forests | Patchwise Training | Merged with CRFs | Clockworks Net |
|CRFs |Pixelwise Training | Using RNNs |Using RNNs |
|Boosting | Multiscale |

- 在经典方式中，主要使用了随机森林分类器和条件随机场（Conditional Random Fields， CRF）。CRF 被认为是解决结构化预测问题的一个方法，语义分割可以表示为 CRF 问题。其使用的Energy function 通常包含一元势函数（用于给出像素是否属于某个类别的概率）和点对势函数（确保所连接像素之间的标签一致性）。 Boost 方法是可以用来对像素进行分类的另一种方法。 它是基于多个组合弱分类器的，这些分类器基于一些形状滤波器的结果。经典方法总受所使用的人工标注特征的限制。

- 完全卷积网络 （FCN）是最近发展较快的方法。有三种不同的子分类。第一种基于分片（patch-wise， 即以感兴趣的像素为中心取一个区域的方式）的训练方法以避免最终分类；第二类基于分像素进行分类的方式，先生成热度图（heatmap），之后使用去卷积的方式进行上采样以得出密集的预测图；第三种使用了多尺度下的语义分割方法。包括合并不同分辨路热度图的 Skip-Net 方法和膨胀卷积方法。

- 结构化模型方法旨在利用先前的成果，利用其结构来分割现在的数据。该方法在自动驾驶的场景下变得尤为实用。常用的用于合并架构的模型是条件化随机场（CRF）。另一种结构化模型的方式便是使用递归神经网络（RNN）。

- 上述方法仍是在图像分割的基础上进行研究的，然而目前已经有基于视频的语义分割研究正在进行，这种分割利用了空间信息。在时空模型中也使用了 FCN。

#### 自动驾驶中的深度语义分割

- 该节着重于自动驾驶的问题以及如何在其中使用语义分割。

##### 问题结构

- 可以从一些方面入手，先对自动驾驶过程中的输入进行预处理，使得复杂度得以降低。对于空间数据可以根据输入画面一般的结构（道路一般在图像的下半，车道一般在平地上，etc）和一般物体的形状，颜色等的特征以及位置信息对画面进行处理。另外，自动驾驶一般使用多个摄像头的组合数据以获得车辆周围的所有影像数据。在汽车的运动过程中，各摄像头采集到的数据总有一定的空间关系，例如，在车左转弯时，前摄像头拍摄到的图像会和一定时间后右摄像头拍摄到的图像相同，同时各摄像头拍摄到的接近地面的影像也近似。

##### 密集的高分辨率地图

- 目前高准确率的物体识别是一个难以实现的课题，而高分辨率的地图是该课题的一个解决方法。目前可用的高分辨率地图有两种，一种是密集语义点云地图（Dense Semantic Point Cloud Map）另一种是基于标志的地图（Landmark based Maps)。密集语义点云地图即把整个场景转换为带有语义的 3D 点云，该方法覆盖面较窄且对内存要求较高。目前 Google 和 TomTom RoadDNA 采用了这个技术。基于标志的地图使用了语义分割的物体，而不是一般的 3D 点云，一般对摄像机数据起作用，Mobileye 和 HERE 使用了这种方法。HD地图还可用于验证或对语义分割进行后处理，以消除误差。 这种情况下，上述两种地图类型均可以使用。

##### 定位

- 定位或深度估计对于自动驾驶至关重要。 有没有定位的图像语义数据可用程度降低。为获取深度数据，有两种可用的方法，即借助运动结构的深度数据（Depth using Structure from Motion， SFM），或是使用激光雷达（LIDAR）的数据。除此之外，使用深度网络的联合定位（Joint In-the-Network Localization）使用了卷积神经网络对结构和摄像机移动进行估计。

#### 主要挑战

- 第四节介绍了自动驾驶应用中遇到的主要问题和试图解决问题的方法。

##### 在嵌入式系统中的性能问题

- 文中测试了 Enet 在 Nvidia Tegra X1上的运行情况。在720p视频输入的情况下算法的处理速度达到 4fps，该效率无法用于实际环境。降低到 VGA 分辨率下处理速度有所提高但准确率下降，无法侦测到小型的物体。另外，系统要处理至少4个摄像头的数据，使得性能进一步降低。
- 但随着针对 CNN 的硬件加速器的出现和深度网络设计的不断优化，处理数据的效率也在不断增加。

##### 对大型带标注的数据集的需求

- 随着数据集 ImageNet 的出现，人们能够意识到深度学习的潜力。而语义分割相比其他算法有更高的复杂性，意味着需要更大的数据集。而针对语义分割的标注则需要更多的时间，借助激光雷达等手段可以缩短这一时间。
- 常用的数据集是 CamVid， 也有合成的数据集，例如 Synthia 和 Virtual KITTI。
- 最近也由更大的数据集出现，例如Mapillary Vistas 或者是 Toronto City。 

##### 学习方面的挑战

- 分类不平衡
- 未观察过的物体
- 输出复杂
- 难以区分单个对象
- 目标取向不明确
- 物体的复杂度可变
- 对于边缘案例难以分析

#### 其他可替代的应用架构
- 该节讨论了包括端到端学习和多任务学习在内的用于替代纯语义分割的方法。

- 多任务学习：使用一个通用的 CNN 完成物体检测，场景分类，车辆检测等多种任务。
- 端到端学习：不需要十分准确的标注，通过控制域网络 （Controller Area Network，CAN）获得驾驶时的控制信息。
- 模块化的端到端学习

#### 评估和设计探索
- 该节对语义分割体系结构进行了比较评估。

##### 评估
- 使用的数据集： CamVid
- 评估指标： MIoU 和速度
- 参与评估的语义分割架构：Unet， Xecption， Dilated FCN16s， FCN8s， Segnet Basic，Dilation8， Enet。

###### 评估结果：
- Dilation8 在 MIoU 指标上效果最好，但运行时间最长。其膨胀卷积的思想可以用于较浅的深度网络。
- Dilated FCN16s 是 FCN-16s 的修改版，减少了网络大小和运行时间，适合实时应用。
- Unet 最初用于医疗方面的语义分割，但其在 CamVid 数据集上的效果在所有架构中排第二，但其运行时间仍不能用于实际情况。
- Xception 最初设计用于分类，但经改造也可用于分割，其 MIoU 较低，运行时间相较 Segnet 有所医生。
- Segnet 虽然不是分割用途中最为先进的算法，但其能够做到 MIoU 和运行速度的平衡。

##### 设计探索

下列是一些在设计语义分割架构的深度网络时的一些参考建议。
- 使用类似于 VGG 架构的 3x3 卷积
- 推荐在分割过程中使用扩张卷积，因为其可以再不降低分辨率的情况下增加感受野。
- 在实时任务中可以适当降低准确率，以提升运行速度。
- 批标准化（Batch normalization）是一个实现更好收敛的有效技巧。
- 输入图像的分辨率极大影响了分割结果
- 使用 Skip connections。

#### 结论
- 该节对之前的工作进行了总结并提出了结论。
- （略）
